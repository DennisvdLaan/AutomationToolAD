import yaml
import re

def load_exploits(yaml_path="config/exploits.yaml"):
    with open(yaml_path, "r") as f:
        data = yaml.safe_load(f)
    return data["exploits"]

def is_vulnerable(os_versions, vulnerable_patterns):
    for os_version in os_versions:
        for pattern in vulnerable_patterns:
            if re.search(pattern, os_version, re.IGNORECASE):
                return True
    return False
